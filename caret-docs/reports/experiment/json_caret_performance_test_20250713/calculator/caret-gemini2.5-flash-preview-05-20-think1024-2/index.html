<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>간단한 계산기</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="calculator">
        <div class="display" id="display">0</div>
        <div class="buttons">
            <button class="button clear">C</button>
            <button class="button operator">/</button>
            <button class="button operator">*</button>
            <button class="button operator">-</button>
            <button class="button number">7</button>
            <button class="button number">8</button>
            <button class="button number">9</button>
            <button class="button operator">+</button>
            <button class="button number">4</button>
            <button class="button number">5</button>
            <button class="button number">6</button>
            <button class="button equals">=</button>
            <button class="button number">1</button>
            <button class="button number">2</button>
            <button class="button number">3</button>
            <button class="button number zero">0</button>
            <button class="button decimal">.</button>
        </div>
    </div>
    <script src="script.js"></script>
    <script>
        // UI 관련 로직 (브라우저 환경에서만 실행)
        document.addEventListener('DOMContentLoaded', () => {
            const display = document.getElementById('display');
            const buttons = document.querySelectorAll('.button');

            let currentInput = '';
            let previousInput = '';
            let operator = null;
            let resultDisplayed = false;

            buttons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const value = e.target.textContent;

                    if (value >= '0' && value <= '9') {
                        if (resultDisplayed) {
                            currentInput = value;
                            resultDisplayed = false;
                        } else {
                            currentInput += value;
                        }
                        display.textContent = currentInput;
                    } else if (value === '.') {
                        if (!currentInput.includes('.')) {
                            currentInput += value;
                            display.textContent = currentInput;
                        }
                    } else if (value === 'C') {
                        currentInput = '';
                        previousInput = '';
                        operator = null;
                        display.textContent = '0';
                        resultDisplayed = false;
                    } else if (value === '=') {
                        if (currentInput !== '' && previousInput !== '' && operator !== null) {
                            const num1 = parseFloat(previousInput);
                            const num2 = parseFloat(currentInput);
                            const calculationResult = operate(operator, num1, num2);

                            if (typeof calculationResult === 'string' && calculationResult.startsWith('Error')) {
                                display.textContent = calculationResult;
                            } else {
                                display.textContent = calculationResult;
                                currentInput = calculationResult.toString();
                            }
                            previousInput = '';
                            operator = null;
                            resultDisplayed = true;
                        }
                    } else { // Operators (+, -, *, /)
                        if (currentInput === '' && previousInput === '') {
                            // 아무것도 입력되지 않은 상태에서 연산자 입력 시 무시
                            return;
                        }

                        if (previousInput !== '' && currentInput !== '' && operator !== null) {
                            // 연속 연산 처리: 이전 결과로 다음 연산 수행
                            const num1 = parseFloat(previousInput);
                            const num2 = parseFloat(currentInput);
                            const calculationResult = operate(operator, num1, num2);

                            if (typeof calculationResult === 'string' && calculationResult.startsWith('Error')) {
                                display.textContent = calculationResult;
                                currentInput = '';
                                previousInput = '';
                                operator = null;
                                resultDisplayed = true;
                                return;
                            } else {
                                previousInput = calculationResult.toString();
                                currentInput = '';
                                operator = value;
                                display.textContent = previousInput; // 이전 결과 표시
                            }
                        } else {
                            previousInput = currentInput;
                            currentInput = '';
                            operator = value;
                            display.textContent = previousInput; // 현재 입력된 숫자 표시
                        }
                        resultDisplayed = false;
                    }
                });
            });
        });
    </script>
</body>
</html>
