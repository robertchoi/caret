# AI ë©”ì‹œì§€ ì†¡ìˆ˜ì‹  í”Œë¡œìš° ê°€ì´ë“œ

**ì‘ì„±ì¼**: 2025-01-28  
**ì‘ì„±ì**: Alpha  
**ëŒ€ìƒ**: Caret ê°œë°œì  

## ğŸ“‹ **ê°œìš”**

ì´ ë¬¸ì„œëŠ” Caretì—ì„œ ì‚¬ìš©ìê°€ AIì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê³  ì‘ë‹µì„ ë°›ëŠ” ì „ì²´ ê³¼ì •ì„ ìƒì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤. 
Frontend â†’ Backend â†’ AI API â†’ Backend â†’ Frontendì˜ ì™„ì „í•œ í”Œë¡œìš°ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.

## ğŸ¯ **ì£¼ìš” í•™ìŠµ ëª©í‘œ**

- AI ë©”ì‹œì§€ ì†¡ìˆ˜ì‹ ì˜ ì „ì²´ ì•„í‚¤í…ì²˜ ì´í•´
- ê° ê³„ì¸µë³„ ì—­í• ê³¼ ì±…ì„ íŒŒì•…
- ë””ë²„ê¹… ì‹œ ë¬¸ì œ ì§€ì  ì‹ë³„ ëŠ¥ë ¥ í–¥ìƒ
- ìƒˆë¡œìš´ AI ëª¨ë“œ ì¶”ê°€ ì‹œ í•„ìš”í•œ ìˆ˜ì •ì‚¬í•­ ì´í•´

---

## ğŸ—ï¸ **ì „ì²´ ì•„í‚¤í…ì²˜ ê°œìš”**

### **ì‹œìŠ¤í…œ êµ¬ì¡°ë„**

```mermaid
graph TB
    User[ğŸ‘¤ ì‚¬ìš©ì] --> UI[ğŸ¨ WebView UI]
    UI --> Proto[ğŸ“¡ Protocol Buffers]
    Proto --> Backend[âš™ï¸ Backend Task]
    Backend --> API[ğŸ¤– AI API]
    API --> Backend
    Backend --> Proto
    Proto --> UI
    UI --> User
    
    subgraph "Frontend Layer"
        UI
        ChatView[ChatView.tsx]
        ChatRow[ChatRow.tsx]
        StateContext[ExtensionStateContext]
    end
    
    subgraph "Communication Layer"
        Proto
        TaskService[TaskServiceClient]
        Messages[ExtensionMessage]
        ProtoConv[Proto Conversions]
    end
    
    subgraph "Backend Layer"
        Backend
        Task[Task.ts]
        SystemPrompt[SystemPrompt]
        WebviewProvider[WebviewProvider]
    end
    
    subgraph "AI Layer"
        API
        Claude[Claude API]
        OpenAI[OpenAI API]
        Gemini[Gemini API]
    end
```

### **ë©”ì‹œì§€ í”Œë¡œìš° ì‹œí€€ìŠ¤**

```mermaid
sequenceDiagram
    participant User as ğŸ‘¤ ì‚¬ìš©ì
    participant ChatView as ğŸ¨ ChatView
    participant TaskClient as ğŸ“¡ TaskServiceClient
    participant WebviewProvider as ğŸ”§ WebviewProvider
    participant Task as âš™ï¸ Task
    participant AI as ğŸ¤– AI API
    participant ChatRow as ğŸ–¼ï¸ ChatRow
    
    Note over User, ChatRow: ğŸ“¤ 1ë‹¨ê³„: ì‚¬ìš©ì ë©”ì‹œì§€ ì „ì†¡
    User->>ChatView: ë©”ì‹œì§€ ì…ë ¥ & ì „ì†¡
    ChatView->>TaskClient: handleSendMessage()
    TaskClient->>WebviewProvider: postMessage({type: "newTask"})
    WebviewProvider->>Task: startTask()
    
    Note over User, ChatRow: âš™ï¸ 2ë‹¨ê³„: Backend ì²˜ë¦¬
    Task->>Task: initiateTaskLoop()
    Task->>Task: generateSystemPrompt()
    Task->>AI: createMessage() - ìŠ¤íŠ¸ë¦¬ë° ì‹œì‘
    
    Note over User, ChatRow: ğŸ¤– 3ë‹¨ê³„: AI ì‘ë‹µ ì²˜ë¦¬
    AI-->>Task: ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ (ë„êµ¬ ì‚¬ìš© í¬í•¨)
    Task->>Task: presentAssistantMessage()
    Task->>Task: chatbot_mode_respond ê°ì§€
    Task->>Task: ask("chatbot_mode_respond", response)
    
    Note over User, ChatRow: ğŸ“¡ 4ë‹¨ê³„: ìƒíƒœ ì „ì†¡
    Task->>WebviewProvider: postStateToWebview()
    WebviewProvider->>ChatView: postMessage({type: "state"})
    ChatView->>ChatView: setClineMessages()
    
    Note over User, ChatRow: ğŸ¨ 5ë‹¨ê³„: UI ì—…ë°ì´íŠ¸
    ChatView->>ChatView: useEffect - ë©”ì‹œì§€ ë³€ê²½ ê°ì§€
    ChatView->>ChatView: setClineAsk("chatbot_mode_respond")
    ChatView->>ChatRow: ë©”ì‹œì§€ ë Œë”ë§
    ChatRow->>ChatRow: renderAskMessage()
    ChatRow->>User: AI ì‘ë‹µ í‘œì‹œ
    
    Note over User, ChatRow: ğŸ”„ 6ë‹¨ê³„: ì‚¬ìš©ì í”¼ë“œë°±
    User->>ChatView: í”¼ë“œë°± ì…ë ¥
    ChatView->>TaskClient: askResponse()
    TaskClient->>Task: handleWebviewAskResponse()
    Task->>Task: askResponse.resolve()
    Task->>Task: ë‹¤ìŒ API í˜¸ì¶œ ì¤€ë¹„
```

### **ìƒíƒœ ê´€ë¦¬ í”Œë¡œìš°**

```mermaid
stateDiagram-v2
    [*] --> Idle: ì´ˆê¸° ìƒíƒœ
    
    Idle --> Sending: ì‚¬ìš©ì ë©”ì‹œì§€ ì…ë ¥
    Sending --> Processing: Backend ì²˜ë¦¬ ì‹œì‘
    Processing --> Streaming: AI API í˜¸ì¶œ
    Streaming --> ToolDetected: ë„êµ¬ ì‚¬ìš© ê°ì§€
    
    ToolDetected --> AskWaiting: ask() í˜¸ì¶œ
    AskWaiting --> UIUpdated: WebView ìƒíƒœ ì—…ë°ì´íŠ¸
    UIUpdated --> UserInput: ì‚¬ìš©ì ì‘ë‹µ ëŒ€ê¸°
    
    UserInput --> ResponseReceived: ì‚¬ìš©ì í”¼ë“œë°±
    ResponseReceived --> Processing: ë‹¤ìŒ ì²˜ë¦¬ ì‹œì‘
    
    Processing --> Completed: ì‘ì—… ì™„ë£Œ
    Completed --> Idle: ëŒ€ê¸° ìƒíƒœ ë³µê·€
    
    note right of AskWaiting
        clineAsk = "chatbot_mode_respond"
        sendingDisabled = false
        enableButtons = false
    end note
    
    note right of UIUpdated
        ChatRowì—ì„œ ì‘ë‹µ ë Œë”ë§
        ì˜µì…˜ ë²„íŠ¼ í‘œì‹œ
        ë§ˆí¬ë‹¤ìš´ ì²˜ë¦¬
    end note
```

---

## ğŸ“¤ **1ë‹¨ê³„: ì‚¬ìš©ì ë©”ì‹œì§€ ì „ì†¡ (Frontend â†’ Backend)**

### **1.1 ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬**

**íŒŒì¼**: `webview-ui/src/components/chat/ChatView.tsx`

```typescript
// ì‚¬ìš©ìê°€ ë©”ì‹œì§€ ì…ë ¥ í›„ ì „ì†¡ ë²„íŠ¼ í´ë¦­
const handleSendMessage = useCallback(
    async (text: string, images: string[], files: string[]) => {
        if (messages.length === 0) {
            // ìƒˆë¡œìš´ íƒœìŠ¤í¬ ì‹œì‘
            await TaskServiceClient.newTask(
                NewTaskRequest.create({ text: messageToSend, images, files })
            )
        } else if (clineAsk) {
            // ê¸°ì¡´ ëŒ€í™”ì—ì„œ AIê°€ ì‘ë‹µ ëŒ€ê¸° ì¤‘ì¸ ê²½ìš°
            switch (clineAsk) {
                case "followup":
                case "plan_mode_respond":
                case "chatbot_mode_respond":
                    await TaskServiceClient.askResponse(
                        AskResponseRequest.create({
                            responseType: "messageResponse",
                            text: messageToSend,
                            images,
                            files,
                        })
                    )
                    break
            }
        }
    },
    [messages.length, clineAsk]
)
```

### **1.2 Protocol Buffer í†µì‹ **

**íŒŒì¼**: `webview-ui/src/services/TaskServiceClient.ts`

```typescript
// TaskServiceClientê°€ Protocol Bufferë¥¼ í†µí•´ Backendì™€ í†µì‹ 
export class TaskServiceClient {
    static async newTask(request: NewTaskRequest): Promise<void> {
        return vscode.postMessage({
            type: "newTask",
            request: NewTaskRequest.toBinary(request)
        })
    }
    
    static async askResponse(request: AskResponseRequest): Promise<void> {
        return vscode.postMessage({
            type: "askResponse", 
            request: AskResponseRequest.toBinary(request)
        })
    }
}
```

### **1.3 Backend ë©”ì‹œì§€ ìˆ˜ì‹ **

**íŒŒì¼**: `src/core/webview/index.ts`

```typescript
// Extensionì´ WebView ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í•˜ê³  Taskë¡œ ì „ë‹¬
case "newTask":
    const newTaskRequest = NewTaskRequest.fromBinary(message.request)
    await task.startTask(
        newTaskRequest.text,
        newTaskRequest.images,
        newTaskRequest.files
    )
    break

case "askResponse":
    const askResponseRequest = AskResponseRequest.fromBinary(message.request)
    await task.handleWebviewAskResponse(
        askResponseRequest.responseType,
        askResponseRequest.text,
        askResponseRequest.images,
        askResponseRequest.files
    )
    break
```

---

## âš™ï¸ **2ë‹¨ê³„: Backend ì²˜ë¦¬ ë° AI API í˜¸ì¶œ**

### **2.1 Task í´ë˜ìŠ¤ì—ì„œ ë©”ì‹œì§€ ì²˜ë¦¬**

**íŒŒì¼**: `src/core/task/index.ts`

```typescript
// Task.startTask() ë˜ëŠ” Task.handleWebviewAskResponse() í˜¸ì¶œ
private async startTask(task?: string, images?: string[], files?: string[]): Promise<void> {
    // 1. ì‚¬ìš©ì ë©”ì‹œì§€ë¥¼ UserContentë¡œ ë³€í™˜
    const userContent: UserContent = [
        { type: "text", text: task || "" }
    ]
    
    // 2. ì´ë¯¸ì§€/íŒŒì¼ ì²¨ë¶€ ì²˜ë¦¬
    if (images?.length) {
        userContent.push(...formatResponse.imageBlocks(images))
    }
    
    // 3. AI API ìš”ì²­ ì‹œì‘
    await this.initiateTaskLoop(userContent)
}
```

### **2.2 ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ìƒì„±**

**íŒŒì¼**: `caret-src/core/prompts/CaretSystemPrompt.ts`

```typescript
// ëª¨ë“œë³„ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ìƒì„±
async generateFromJsonSections(
    cwd: string,
    supportsBrowserUse: boolean,
    mcpHub: any,
    browserSettings: any,
    isClaude4ModelFamily: boolean = false,
    mode: "chatbot" | "agent" = "agent",
): Promise<string> {
    // 1. ê¸°ë³¸ ì„¹ì…˜ ë¡œë“œ (ë„êµ¬ ì •ì˜ í¬í•¨)
    const baseSections = await this.assembler.loadBaseSections(mode)
    
    // 2. ë™ì  ì„¹ì…˜ ìƒì„± (MCP, ì‹œìŠ¤í…œ ì •ë³´)
    const dynamicSections = await this.assembler.generateDynamicSections(cwd, mcpHub)
    
    // 3. ì¡°ê±´ë¶€ ì„¹ì…˜ ì¶”ê°€ (ë¸Œë¼ìš°ì €, Claude4)
    const conditionalSections = await this.assembler.addConditionalSections(
        supportsBrowserUse, browserSettings, isClaude4ModelFamily, mode
    )
    
    // 4. ìµœì¢… í”„ë¡¬í”„íŠ¸ ì¡°ë¦½
    return this.assembler.assembleFinalPrompt(allSections)
}
```

### **2.3 ë„êµ¬ í•„í„°ë§ (ëª¨ë“œë³„)**

**íŒŒì¼**: `caret-src/core/prompts/JsonSectionAssembler.ts`

```typescript
// ì±—ë´‡ ëª¨ë“œ: ì½ê¸° ì „ìš© ë„êµ¬ + chatbot_mode_respondë§Œ í—ˆìš©
if (mode === "chatbot") {
    const readOnlyTools = [
        "read_file", 
        "search_files", 
        "list_files", 
        "list_code_definition_names", 
        "chatbot_mode_respond"  // ğŸ”‘ í•µì‹¬: ì‘ë‹µ ë„êµ¬ í¬í•¨
    ]
    if (!readOnlyTools.includes(toolName)) {
        continue // ë‹¤ë¥¸ ë„êµ¬ë“¤ì€ ì œì™¸
    }
}
```

### **2.4 AI API í˜¸ì¶œ**

**íŒŒì¼**: `src/core/task/index.ts`

```typescript
// recursivelyMakeClineRequests()ì—ì„œ ì‹¤ì œ AI API í˜¸ì¶œ
async *attemptApiRequest(previousApiReqIndex: number): ApiStream {
    // 1. ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ + ëŒ€í™” íˆìŠ¤í† ë¦¬ êµ¬ì„±
    const systemPrompt = await this.generateSystemPrompt()
    const messages = [
        { role: "system", content: systemPrompt },
        ...this.apiConversationHistory
    ]
    
    // 2. AI API í˜¸ì¶œ (Claude, OpenAI ë“±)
    for await (const chunk of this.api.createMessage(messages)) {
        yield chunk
    }
}
```

---

## ğŸ¤– **3ë‹¨ê³„: AI ì‘ë‹µ ì²˜ë¦¬ (Backend)**

### **3.1 ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ íŒŒì‹±**

**íŒŒì¼**: `src/core/task/index.ts`

```typescript
// AI ì‘ë‹µì„ ì‹¤ì‹œê°„ìœ¼ë¡œ íŒŒì‹±í•˜ì—¬ ë„êµ¬ í˜¸ì¶œ ê°ì§€
async presentAssistantMessage() {
    // 1. ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µì„ AssistantMessageContentë¡œ íŒŒì‹±
    this.assistantMessageContent = parseAssistantMessageV2(assistantMessage)
    
    // 2. ë„êµ¬ ì‚¬ìš© ë¸”ë¡ ì²˜ë¦¬
    for (const block of this.assistantMessageContent) {
        if (block.type === "tool_use") {
            switch (block.name) {
                case "chatbot_mode_respond": {
                    // ì±—ë´‡ ì‘ë‹µ ì²˜ë¦¬ (Plan ëª¨ë“œì™€ ë™ì¼)
                    const response = block.params.response
                    const sharedMessage = {
                        response: removeClosingTag("response", response),
                        options: parsePartialArrayString(removeClosingTag("options", optionsRaw)),
                    }
                    
                    // ì‚¬ìš©ì ì‘ë‹µ ëŒ€ê¸°
                    let { text, images, files } = await this.ask(
                        "chatbot_mode_respond", 
                        JSON.stringify(sharedMessage), 
                        false
                    )
                    
                    // ì‚¬ìš©ì í”¼ë“œë°± ì²˜ë¦¬
                    pushToolResult(formatResponse.toolResult(`<user_message>\n${text}\n</user_message>`))
                    break
                }
            }
        }
    }
}
```

### **3.2 Ask ë©”ì‹œì§€ ìƒì„±**

**íŒŒì¼**: `src/core/task/index.ts`

```typescript
// AIê°€ ì‚¬ìš©ì ì‘ë‹µì„ ìš”ì²­í•  ë•Œ
async ask(
    type: ClineAsk,
    text?: string,
    partial?: boolean,
): Promise<{ response: ClineAskResponse; text?: string; images?: string[]; files?: string[] }> {
    // 1. ClineMessage ìƒì„±
    const message: ClineMessage = {
        ts: Date.now(),
        type: "ask",
        ask: type,  // "chatbot_mode_respond"
        text: text, // AI ì‘ë‹µ ë‚´ìš©
        partial: partial
    }
    
    // 2. ë©”ì‹œì§€ ì €ì¥ ë° WebViewë¡œ ì „ì†¡
    await this.addToClineMessages(message)
    await this.postStateToWebview()
    
    // 3. ì‚¬ìš©ì ì‘ë‹µ ëŒ€ê¸°
    return new Promise((resolve) => {
        this.askResponse = resolve
    })
}
```

---

## ğŸ“¡ **4ë‹¨ê³„: Backend â†’ Frontend ìƒíƒœ ì „ì†¡**

### **4.1 ìƒíƒœ ì—…ë°ì´íŠ¸**

**íŒŒì¼**: `src/core/task/index.ts`

```typescript
// WebViewë¡œ ìƒíƒœ ì „ì†¡
private async postStateToWebview(): Promise<void> {
    const state: ExtensionState = {
        version: this.context.extension.packageJSON.version,
        clineMessages: this.clineMessages,  // ğŸ”‘ ë©”ì‹œì§€ ë°°ì—´
        taskHistory: await this.getTaskHistory(),
        shouldShowAnnouncement: await this.getShouldShowAnnouncement()
    }
    
    await this.postMessageToWebview({
        type: "state",
        state: state
    })
}
```

### **4.2 Protocol Buffer ì—­ì§ë ¬í™”**

**íŒŒì¼**: `webview-ui/src/context/ExtensionStateContext.tsx`

```typescript
// WebViewì—ì„œ Backend ë©”ì‹œì§€ ìˆ˜ì‹ 
useEffect(() => {
    const handleMessage = (event: MessageEvent) => {
        const message: ExtensionMessage = event.data
        
        switch (message.type) {
            case "state":
                // ìƒíƒœ ì—…ë°ì´íŠ¸
                setClineMessages(message.state.clineMessages)
                setTaskHistory(message.state.taskHistory)
                break
        }
    }
    
    window.addEventListener("message", handleMessage)
    return () => window.removeEventListener("message", handleMessage)
}, [])
```

---

## ğŸ¨ **5ë‹¨ê³„: Frontend UI ì—…ë°ì´íŠ¸**

### **5.1 ChatView ìƒíƒœ ê´€ë¦¬**

**íŒŒì¼**: `webview-ui/src/components/chat/ChatView.tsx`

```typescript
// ë©”ì‹œì§€ ë³€ê²½ ê°ì§€ ë° UI ìƒíƒœ ì—…ë°ì´íŠ¸
useEffect(() => {
    const lastMessage = modifiedMessages.at(-1)
    
    if (lastMessage?.type === "ask") {
        switch (lastMessage.ask) {
            case "chatbot_mode_respond":
                setSendingDisabled(isPartial)        // ì „ì†¡ ë²„íŠ¼ ìƒíƒœ
                setClineAsk("chatbot_mode_respond")   // Ask íƒ€ì… ì„¤ì •
                setEnableButtons(false)               // ë²„íŠ¼ í™œì„±í™” ìƒíƒœ
                break
        }
    }
}, [modifiedMessages])
```

### **5.2 ChatRow ë©”ì‹œì§€ ë Œë”ë§**

**íŒŒì¼**: `webview-ui/src/components/chat/ChatRow.tsx`

```typescript
// Ask íƒ€ì…ë³„ ë©”ì‹œì§€ ë Œë”ë§
function renderAskMessage(message: ClineMessage) {
    switch (message.ask) {
        case "chatbot_mode_respond": {
            // JSON íŒŒì‹±í•˜ì—¬ ì‘ë‹µ ë‚´ìš© ì¶”ì¶œ
            let response: string | undefined
            let options: string[] | undefined
            let selected: string | undefined
            
            try {
                const parsedMessage = JSON.parse(message.text || "{}") as ClinePlanModeResponse
                response = parsedMessage.response
                options = parsedMessage.options
                selected = parsedMessage.selected
            } catch (e) {
                response = message.text // ë ˆê±°ì‹œ ë©”ì‹œì§€ ì²˜ë¦¬
            }
            
            // ë§ˆí¬ë‹¤ìš´ ë Œë”ë§ + ì˜µì…˜ ë²„íŠ¼
            return (
                <WithCopyButton textToCopy={response}>
                    <Markdown markdown={response} />
                    <OptionsButtons
                        options={options}
                        selected={selected}
                        isActive={isLast && lastModifiedMessage?.ask === "chatbot_mode_respond"}
                    />
                </WithCopyButton>
            )
        }
    }
}
```

---

## ğŸ”„ **6ë‹¨ê³„: ì‚¬ìš©ì ì‘ë‹µ ì²˜ë¦¬ (Frontend â†’ Backend)**

### **6.1 ì‚¬ìš©ì ì…ë ¥ ì „ì†¡**

ì‚¬ìš©ìê°€ AI ì‘ë‹µì— ëŒ€í•´ í”¼ë“œë°±ì„ ì…ë ¥í•˜ë©´, **1ë‹¨ê³„**ì™€ ë™ì¼í•œ ê³¼ì •ìœ¼ë¡œ ë‹¤ì‹œ Backendë¡œ ì „ì†¡ë©ë‹ˆë‹¤:

```typescript
// ChatView.tsx - handleSendMessage()
case "chatbot_mode_respond":
    await TaskServiceClient.askResponse(
        AskResponseRequest.create({
            responseType: "messageResponse",
            text: messageToSend,
            images,
            files,
        })
    )
```

### **6.2 Backendì—ì„œ ì‚¬ìš©ì ì‘ë‹µ ì²˜ë¦¬**

**íŒŒì¼**: `src/core/task/index.ts`

```typescript
// Task.handleWebviewAskResponse()
async handleWebviewAskResponse(askResponse: ClineAskResponse, text?: string, images?: string[], files?: string[]) {
    // 1. ëŒ€ê¸° ì¤‘ì¸ Promise í•´ê²°
    if (this.askResponse) {
        this.askResponse({
            response: askResponse,
            text: text,
            images: images,
            files: files
        })
        this.askResponse = undefined
    }
}
```

---

## ğŸš¨ **ì£¼ìš” ë””ë²„ê¹… í¬ì¸íŠ¸**

### **ë¬¸ì œ ë°œìƒ ì‹œ í™•ì¸ì‚¬í•­**

1. **AIê°€ ì‘ë‹µí•˜ì§€ ì•ŠëŠ” ê²½ìš°**:
   - ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ì— í•´ë‹¹ ë„êµ¬ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ê°€? (`JsonSectionAssembler.ts`)
   - Backendì—ì„œ ë„êµ¬ ì²˜ë¦¬ ì¼€ì´ìŠ¤ê°€ êµ¬í˜„ë˜ì–´ ìˆëŠ”ê°€? (`Task.ts`)

2. **ì‘ë‹µì´ UIì— í‘œì‹œë˜ì§€ ì•ŠëŠ” ê²½ìš°**:
   - ChatRowì—ì„œ í•´ë‹¹ Ask íƒ€ì… ì¼€ì´ìŠ¤ê°€ êµ¬í˜„ë˜ì–´ ìˆëŠ”ê°€? (`ChatRow.tsx`)
   - ChatViewì—ì„œ ìƒíƒœ ê´€ë¦¬ê°€ ì˜¬ë°”ë¥¸ê°€? (`ChatView.tsx`)

3. **ë¬´í•œ ë£¨í”„ê°€ ë°œìƒí•˜ëŠ” ê²½ìš°**:
   - Backendì—ì„œ `didAlreadyUseTool` í”Œë˜ê·¸ê°€ ì„¤ì •ë˜ëŠ”ê°€?
   - `recursivelyMakeClineRequests()`ì—ì„œ ë£¨í”„ ì¢…ë£Œ ì¡°ê±´ì´ ì˜¬ë°”ë¥¸ê°€?

### **ë¡œê¹… í™•ì¸ ë°©ë²•**

```typescript
// Backend ë¡œê¹…
Logger.info(`[CHATBOT-MODE] Processing tool: ${block.name}`)

// Frontend ë¡œê¹…  
console.log("[ChatView] handleSendMessage - Sending message:", messageToSend)
```

---

## ğŸ“š **ê´€ë ¨ ë¬¸ì„œ**

- [Caret ì•„í‚¤í…ì²˜ ê°€ì´ë“œ](./caret-architecture-and-implementation-guide.mdx)
- [í…ŒìŠ¤íŒ… ê°€ì´ë“œ](./testing-guide.mdx)
- [Frontend-Backend ìƒí˜¸ì‘ìš© íŒ¨í„´](./frontend-backend-interaction-patterns.mdx)
- [ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ êµ¬í˜„](./system-prompt-implementation.mdx)

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-01-28  
**ê²€í† ì**: Luke Yang 